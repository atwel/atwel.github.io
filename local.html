<html>
<style>body{background-color:#FCFCFC;}</style>
<title>Notetaker.ja</title>

<script type='text/javascript'>
function saveTextAsFile()
{
    var currentdate = new Date(); 
    var datetime = (currentdate.getMonth()+1)  + "-"
                + currentdate.getDate() + "-" 
                + currentdate.getFullYear() + "_"  
                + currentdate.getHours() + "-"  
                + currentdate.getMinutes();
                
	var textToWrite = "Type:" + document.getElementById("selector").value 
	                    + ";;;\nSubject:" + document.getElementById("subject").value
	                    + ";;;\nKeywords:" + document.getElementById("keywords").value
	                    + ";;;\nDatetime:" + datetime
	                    + ";;;\nText:" + document.getElementById("maintext").value;
	                    
	var textFileAsBlob = new Blob([textToWrite], {type:'text/plain'});
	var fileNameToSaveAs = document.getElementById("filename").value;
	
	if (fileNameToSaveAs === "(optional)"){
	    fileNameToSaveAs = datetime +".txt";
	}

	var downloadLink = document.createElement("a");
	downloadLink.download = fileNameToSaveAs;
	downloadLink.innerHTML = "Download File";
	if (window.webkitURL != null)
	{
		// Chrome allows the link to be clicked
		// without actually adding it to the DOM.
		downloadLink.href = window.webkitURL.createObjectURL(textFileAsBlob);
	}
	else
	{
		// Firefox requires the link to be added to the DOM
		// before it can be clicked.
		downloadLink.href = window.URL.createObjectURL(textFileAsBlob);
		//downloadLink.onclick = destroyClickedElement;
		downloadLink.style.display = "none";
		document.body.appendChild(downloadLink);
	}

	downloadLink.click();
}

function destroyClickedElement(event)
{
	document.body.removeChild(event.target);
}

function loadFileAsText()
{
	var fileToLoad = document.getElementById("fileToLoad").files[0];

	var fileReader = new FileReader();
	fileReader.onload = function(fileLoadedEvent) 
	{
		var textFromFileLoaded = fileLoadedEvent.target.result;
		document.getElementById("inputTextToSave").value = textFromFileLoaded;
	};
	fileReader.readAsText(fileToLoad, "UTF-8");
}

</script>
<script type='text/javascript'>
function check_enter(e){
    if (e.keyCode == 13) {
        var tb = document.getElementById("Tab title").value;
        //title = document.getElementById("Title");
        document.title = tb;
    }
}
</script>
<center>
Tab Title: <input type="text" id="Tab title" onclick="this.value='';" onkeypress="check_enter(event)" value="(optional)">
<br><br><br><br>
<form>
      <fieldset style="width:500px">
        <legend>Basics</legend>
        <table>
          <tr>
            <td>
              <label>Type of Doc:&nbsp </label>            
              <select id="selector">
              <option value="draft">writing</option>
              <option value="notes">notes</options>
              <option value="meeting">meeting notes</option>
              <option value="reminder">reminder</option>
              </select>
            </td>
            <td>
              <label>&nbsp&nbsp&nbspSubject:&nbsp </label>
              <input type="text" id="subject"><br>
            </td></tr>
            <tr><td>
             <label>Keywords:&nbsp </label>
             <input type="text" id="keywords">
            </table>
    </fieldset>
    <br>
    <fieldset style="width:500px">
        <legend>Text and Keywords</legend>
        <table>
            <tr><td><textarea id="maintext" style="width:475px;height:256px"></textarea></td></tr><tr style="height:20px"></tr>
            <tr><td>
            <label>File name:&nbsp</label><input type="text" id="filename" value ="(optional)" onclick="this.value='';" onfocus="this.select()" onblur="this.value=!this.value?'(optional)':this.value;"></td></td>
        </table>
        </fieldset><br>
    <button onclick="saveTextAsFile()">Finish and Save</button>    
    </form>
    </center>
</html>